---
title: Utilities
description: API reference for URL, text, and feed utility functions.
---

scrapex provides utility functions for common operations.

## URL Utilities

### isValidUrl()

Check if a string is a valid URL.

```typescript
function isValidUrl(url: string): boolean
```

#### Example

```typescript
import { isValidUrl } from 'scrapex';

isValidUrl('https://example.com');     // true
isValidUrl('http://localhost:3000');   // true
isValidUrl('not-a-url');               // false
isValidUrl('');                        // false
```

### extractDomain()

Extract the domain from a URL.

```typescript
function extractDomain(url: string): string
```

#### Example

```typescript
import { extractDomain } from 'scrapex';

extractDomain('https://www.example.com/page');     // 'example.com'
extractDomain('https://blog.example.com/post');    // 'blog.example.com'
extractDomain('https://example.com:8080/api');     // 'example.com'
extractDomain('invalid');                          // ''
```

### normalizeUrl()

Normalize a URL for consistent comparison.

```typescript
function normalizeUrl(url: string): string
```

Normalization includes:
- Removing common tracking parameters
- Removing trailing slashes (except root)

#### Example

```typescript
import { normalizeUrl } from 'scrapex';

normalizeUrl('HTTPS://Example.COM/');
// 'HTTPS://Example.COM/'

normalizeUrl('https://example.com:443/page');
// 'https://example.com:443/page'

normalizeUrl('https://example.com?b=2&a=1&utm_source=site');
// 'https://example.com?b=2&a=1'
```

### resolveUrl()

Resolve a relative URL against a base URL.

```typescript
function resolveUrl(url: string | undefined | null, baseUrl: string): string | undefined
```

#### Example

```typescript
import { resolveUrl } from 'scrapex';

resolveUrl('../other', 'https://example.com/page/');
// 'https://example.com/other'

resolveUrl('/about', 'https://example.com/blog/post');
// 'https://example.com/about'

resolveUrl('https://other.com', 'https://example.com');
// 'https://other.com'
```

### isExternalUrl()

Check if a URL is external relative to a base URL.

```typescript
function isExternalUrl(url: string, baseUrl: string): boolean
```

#### Example

```typescript
import { isExternalUrl } from 'scrapex';

isExternalUrl('https://other.com', 'https://example.com');
// true

isExternalUrl('https://example.com/page', 'https://example.com');
// false

isExternalUrl('/page', 'https://example.com');
// false
```

## Feed Utilities

### fetchFeed()

Fetch and parse an RSS/Atom feed.

```typescript
function fetchFeed(
  url: string,
  options?: {
    fetcher?: Fetcher;
    timeout?: number;
    userAgent?: string;
    parserOptions?: RSSParserOptions;
  }
): Promise<ParserResult<ParsedFeed, FeedMeta>>
```

#### Example

```typescript
import { fetchFeed } from 'scrapex';

const result = await fetchFeed('https://example.com/feed.xml');

for (const item of result.data.items) {
  console.log(item.title, item.publishedAt);
}
```

### discoverFeeds()

Find RSS/Atom feed URLs in HTML.

```typescript
function discoverFeeds(html: string, baseUrl: string): string[]
```

#### Example

```typescript
import { discoverFeeds } from 'scrapex';

const feedUrls = discoverFeeds(html, 'https://example.com');
// ['https://example.com/feed.xml', 'https://example.com/atom.xml']
```

### filterByDate()

Filter feed items by date range.

```typescript
function filterByDate(
  items: FeedItem[],
  options: {
    after?: Date;
    before?: Date;
    includeUndated?: boolean;
  }
): FeedItem[]
```

#### Example

```typescript
import { filterByDate } from 'scrapex';

const recentItems = filterByDate(items, {
  after: new Date('2024-01-01'),
  includeUndated: false,
});
```

### feedToMarkdown()

Convert feed to Markdown for LLM consumption.

```typescript
function feedToMarkdown(
  feed: ParsedFeed,
  options?: {
    includeContent?: boolean;
    maxItems?: number;
  }
): string
```

#### Example

```typescript
import { feedToMarkdown } from 'scrapex';

const markdown = feedToMarkdown(feed, { maxItems: 10 });
// # Feed Title
//
// ## Article 1
// *2024-09-06*
//
// Article description...
// [Read more](https://example.com/article)
```

### feedToText()

Convert feed to plain text.

```typescript
function feedToText(
  feed: ParsedFeed,
  options?: {
    maxItems?: number;
    separator?: string;
  }
): string
```

#### Example

```typescript
import { feedToText } from 'scrapex';

const text = feedToText(feed, { maxItems: 5 });
```

### paginateFeed()

Iterate through paginated feeds (RFC 5005).

```typescript
function paginateFeed(
  url: string,
  options?: {
    fetcher?: Fetcher;
    timeout?: number;
    userAgent?: string;
    maxPages?: number;
  }
): AsyncGenerator<ParsedFeed>
```

#### Example

```typescript
import { paginateFeed } from 'scrapex';

for await (const page of paginateFeed(url, { maxPages: 5 })) {
  console.log(`Page with ${page.items.length} items`);
}
```

## Text Utilities

### truncateText()

Truncate text to a maximum length with ellipsis.

```typescript
function truncateText(text: string, maxLength: number): string
```

#### Example

```typescript
import { truncateText } from 'scrapex';

truncateText('Hello, World!', 8);
// 'Hello...'

truncateText('Short', 10);
// 'Short'
```

### cleanText()

Clean and normalize text content.

```typescript
function cleanText(text: string): string
```

Cleaning includes:
- Trimming whitespace
- Collapsing multiple spaces
- Removing control characters

#### Example

```typescript
import { cleanText } from 'scrapex';

cleanText('  Hello   World  \n\n  Test  ');
// 'Hello World Test'
```

### extractText()

Extract visible text from HTML.

```typescript
function extractText(html: string): string
```

#### Example

```typescript
import { extractText } from 'scrapex';

extractText('<p>Hello <strong>World</strong></p>');
// 'Hello World'

extractText('<div><script>alert("x")</script>Text</div>');
// 'Text'
```

## Error Utilities

### ScrapeError

Custom error class for scraping failures.

```typescript
class ScrapeError extends Error {
  constructor(code: ErrorCode, message: string, url?: string);

  readonly code: ErrorCode;
  readonly url?: string;
  readonly statusCode?: number;
}

type ErrorCode =
  | 'FETCH_ERROR'
  | 'TIMEOUT'
  | 'HTTP_ERROR'
  | 'PARSE_ERROR'
  | 'ROBOTS_BLOCKED'
  | 'INVALID_URL'
  | 'CONTENT_TOO_LARGE';
```

#### Example

```typescript
import { ScrapeError, scrape } from 'scrapex';

try {
  await scrape(url);
} catch (error) {
  if (error instanceof ScrapeError) {
    console.log(`Error: ${error.code} - ${error.message}`);
    console.log(`URL: ${error.url}`);
  }
}
```

### createScrapeError()

Factory function for creating ScrapeError instances.

```typescript
function createScrapeError(
  code: ErrorCode,
  message: string,
  url?: string,
  statusCode?: number
): ScrapeError
```

## See Also

- [RSS/Atom Parsing Guide](/guides/rss-parsing) - Feed parsing guide
- [Error Handling Guide](/guides/error-handling) - Error handling patterns
- [Types Reference](/api/types) - Full type definitions
