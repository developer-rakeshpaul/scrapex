---
title: Utilities
description: API reference for URL and feed utility functions.
---

scrapex provides utility functions for URL handling and feed parsing helpers.

## URL Utilities

### isValidUrl()

Check if a string is a valid URL.

```typescript
function isValidUrl(url: string): boolean
```

Only `http://` and `https://` URLs are considered valid.

#### Example

```typescript
import { isValidUrl } from 'scrapex';

isValidUrl('https://example.com');     // true
isValidUrl('http://localhost:3000');   // true
isValidUrl('not-a-url');               // false
isValidUrl('');                        // false
isValidUrl('ftp://example.com');       // false
```

### extractDomain()

Extract the domain from a URL.

```typescript
function extractDomain(url: string): string
```

#### Example

```typescript
import { extractDomain } from 'scrapex';

extractDomain('https://www.example.com/page');     // 'example.com'
extractDomain('https://blog.example.com/post');    // 'blog.example.com'
extractDomain('https://example.com:8080/api');     // 'example.com'
extractDomain('invalid');                          // ''
```

### normalizeUrl()

Normalize a URL for consistent comparison.

```typescript
function normalizeUrl(url: string): string
```

Normalization includes:
- Lowercasing the URL
- Removing default ports (80 for http, 443 for https)
- Removing common tracking parameters (utm_*, fbclid, etc.)

#### Example

```typescript
import { normalizeUrl } from 'scrapex';

normalizeUrl('HTTPS://Example.COM/');
// 'https://example.com/'

normalizeUrl('https://example.com:443/page');
// 'https://example.com/page'

normalizeUrl('https://example.com?b=2&a=1&utm_source=site');
// 'https://example.com/?b=2&a=1'
```

### resolveUrl()

Resolve a relative URL against a base URL.

```typescript
function resolveUrl(url: string | undefined | null, baseUrl: string): string | undefined
```

#### Example

```typescript
import { resolveUrl } from 'scrapex';

resolveUrl('../other', 'https://example.com/page/');
// 'https://example.com/other'

resolveUrl('/about', 'https://example.com/blog/post');
// 'https://example.com/about'

resolveUrl('https://other.com', 'https://example.com');
// 'https://other.com/'
```

### isExternalUrl()

Check if a URL is external relative to a base domain.

```typescript
function isExternalUrl(url: string, baseDomain: string): boolean
```

#### Example

```typescript
import { extractDomain, isExternalUrl } from 'scrapex';

const baseDomain = extractDomain('https://example.com');

isExternalUrl('https://other.com', baseDomain);
// true

isExternalUrl('https://example.com/page', baseDomain);
// false

isExternalUrl('/page', baseDomain);
// false
```

### getProtocol()

Extract the protocol from a URL.

```typescript
function getProtocol(url: string): string
```

#### Example

```typescript
import { getProtocol } from 'scrapex';

getProtocol('https://example.com/path');
// 'https:'
```

### getPath()

Extract the pathname from a URL.

```typescript
function getPath(url: string): string
```

#### Example

```typescript
import { getPath } from 'scrapex';

getPath('https://example.com/docs/intro?ref=nav');
// '/docs/intro'
```

### matchesUrlPattern()

Check if a URL matches a pattern (supports `*` wildcards).

```typescript
function matchesUrlPattern(url: string, pattern: string): boolean
```

The `*` wildcard matches across path segments (for example, `https://example.com/docs/*` matches `https://example.com/docs/a/b/c`).

#### Example

```typescript
import { matchesUrlPattern } from 'scrapex';

matchesUrlPattern('https://example.com/docs/a', 'https://example.com/docs/*');
// true

matchesUrlPattern('https://example.com/blog', 'https://example.com/docs/*');
// false
```

## Feed Utilities

### fetchFeed()

Fetch and parse an RSS/Atom feed.

```typescript
function fetchFeed(
  url: string,
  options?: {
    fetcher?: Fetcher;
    timeout?: number;
    userAgent?: string;
    parserOptions?: RSSParserOptions;
  }
): Promise<ParserResult<ParsedFeed, FeedMeta>>
```

#### Example

```typescript
import { fetchFeed } from 'scrapex';

const result = await fetchFeed('https://example.com/feed.xml');

for (const item of result.data.items) {
  console.log(item.title, item.publishedAt);
}
```

### discoverFeeds()

Find RSS/Atom feed URLs in HTML.

```typescript
function discoverFeeds(html: string, baseUrl: string): string[]
```

#### Example

```typescript
import { discoverFeeds } from 'scrapex';

const feedUrls = discoverFeeds(html, 'https://example.com');
// ['https://example.com/feed.xml', 'https://example.com/atom.xml']
```

### filterByDate()

Filter feed items by date range.

```typescript
function filterByDate(
  items: FeedItem[],
  options: {
    after?: Date;
    before?: Date;
    includeUndated?: boolean;
  }
): FeedItem[]
```

#### Example

```typescript
import { filterByDate } from 'scrapex';

const recentItems = filterByDate(items, {
  after: new Date('2024-01-01'),
  includeUndated: false,
});
```

### feedToMarkdown()

Convert feed to Markdown for LLM consumption.

```typescript
function feedToMarkdown(
  feed: ParsedFeed,
  options?: {
    includeContent?: boolean;
    maxItems?: number;
  }
): string
```

#### Example

```typescript
import { feedToMarkdown } from 'scrapex';

const markdown = feedToMarkdown(feed, { maxItems: 10 });
// # Feed Title
//
// ## Article 1
// *2024-09-06*
//
// Article description...
// [Read more](https://example.com/article)
```

### feedToText()

Convert feed to plain text.

```typescript
function feedToText(
  feed: ParsedFeed,
  options?: {
    maxItems?: number;
    separator?: string;
  }
): string
```

#### Example

```typescript
import { feedToText } from 'scrapex';

const text = feedToText(feed, { maxItems: 5 });
```

### paginateFeed()

Iterate through paginated Atom feeds using [RFC 5005](https://tools.ietf.org/html/rfc5005) (Feed Paging and Archiving). This follows `rel="next"` links to fetch subsequent pages.

```typescript
function paginateFeed(
  url: string,
  options?: {
    fetcher?: Fetcher;
    timeout?: number;
    userAgent?: string;
    maxPages?: number;
  }
): AsyncGenerator<ParsedFeed>
```

#### Example

```typescript
import { paginateFeed } from 'scrapex';

for await (const page of paginateFeed(url, { maxPages: 5 })) {
  console.log(`Page with ${page.items.length} items`);
}
```

## See Also

- [RSS/Atom Parsing Guide](/guides/rss-parsing) - Feed parsing guide
- [Error Handling Guide](/guides/error-handling) - Error handling patterns
- [Types Reference](/api/types) - Full type definitions
