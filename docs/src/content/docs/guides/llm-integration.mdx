---
title: LLM Integration
description: Enhance scraped content with AI-powered summarization, entity extraction, and structured data.
---

import { Tabs, TabItem, Aside } from '@astrojs/starlight/components';

scrapex integrates with LLM providers to enhance scraped content with AI capabilities.

## Setting Up a Provider

<Tabs>
  <TabItem label="OpenAI">
    ```typescript
    import { scrape } from 'scrapex';
    import { createOpenAI } from 'scrapex/llm';

    const openai = createOpenAI({
      apiKey: process.env.OPENAI_API_KEY,
      model: 'gpt-4o-mini', // optional, defaults to gpt-4o-mini
    });
    ```
  </TabItem>
  <TabItem label="Anthropic">
    ```typescript
    import { scrape } from 'scrapex';
    import { AnthropicProvider } from 'scrapex/llm';

    const anthropic = new AnthropicProvider({
      apiKey: process.env.ANTHROPIC_API_KEY,
      model: 'claude-3-5-haiku-20241022', // optional
    });
    ```
  </TabItem>
  <TabItem label="Ollama">
    ```typescript
    import { createOllama } from 'scrapex/llm';

    const ollama = createOllama({
      model: 'llama3.2',
    });
    ```
  </TabItem>
  <TabItem label="LM Studio">
    ```typescript
    import { createLMStudio } from 'scrapex/llm';

    const lmstudio = createLMStudio({
      model: 'local-model',
    });
    ```
  </TabItem>
</Tabs>

## Enhancing Scraped Content

Pass the provider and enhancement types to the `scrape()` function:

```typescript
const result = await scrape('https://example.com/article', {
  llm: openai,
  enhance: ['summarize', 'entities', 'tags'],
});

console.log(result.summary);        // AI-generated summary
console.log(result.entities);       // Extracted entities
console.log(result.suggestedTags);  // Suggested tags
```

## Enhancement Types

### Summarize

Generate a concise summary of the content:

```typescript
const result = await scrape(url, { llm: provider, enhance: ['summarize'] });
console.log(result.summary);
// "This article discusses the latest developments in..."
```

### Extract Entities

Extract named entities (people, organizations, locations, etc.):

```typescript
const result = await scrape(url, { llm: provider, enhance: ['entities'] });
console.log(result.entities);
// {
//   people: ['John Smith', 'Jane Doe'],
//   organizations: ['Acme Corp', 'TechCo'],
//   locations: ['San Francisco', 'New York'],
//   technologies: ['React', 'Node.js'],
// }
```

### Classify

Classify content type (article, repo, docs, etc.):

```typescript
const result = await scrape(url, { llm: provider, enhance: ['classify'] });
console.log(result.contentType);
// 'article', 'repo', 'docs', etc.
```

### Extract Structured Data

Extract specific data using a JSON schema:

```typescript
const result = await scrape(url, {
  llm: provider,
  extract: {
    productName: 'string',
    price: 'number',
    features: 'string[]',
  },
});
console.log(result.extracted);
// { productName: 'Widget Pro', price: 99.99, features: ['Fast', 'Reliable'] }
```

## Chaining Enhancements

Chain multiple enhancements together:

```typescript
const result = await scrape(url, {
  llm: provider,
  enhance: ['summarize', 'entities', 'tags', 'classify'],
  extract: {
    author: 'string',
    topics: 'string[]',
  },
});
```

<Aside type="note">
  Enhancements run in parallel where possible, but each type can add additional API calls and tokens.
</Aside>

## Token Usage

Each enhancement makes one or more LLM API calls. To minimize costs:

- Use `textContent` instead of `content` (plain text uses fewer tokens)
- Set `maxContentLength` to limit input size
- Use smaller/faster models for simple tasks

```typescript
const result = await scrape(url, {
  maxContentLength: 10000, // Limit content to 10k chars
  llm: provider,
  enhance: ['summarize'],
});
```

## Custom Questions with ask()

Use `ask()` for ad-hoc questions about scraped content:

```typescript
import { scrape } from 'scrapex';
import { createOpenAI, ask } from 'scrapex/llm';

const provider = createOpenAI({ model: 'gpt-4o-mini' });
const data = await scrape('https://example.com/article');

// Simple question - returns string
const result = await ask(data, provider, "What is the main argument?", {
  key: 'mainArgument'
});
console.log(result.custom?.mainArgument);
// "The author argues that..."

// Structured response - returns typed object
const sentiment = await ask(data, provider, "Analyze the sentiment", {
  key: 'sentiment',
  schema: { tone: 'string', score: 'number', reasoning: 'string' }
});
console.log(sentiment.custom?.sentiment);
// { tone: 'positive', score: 0.8, reasoning: '...' }
```

### Template Placeholders

Use placeholders in prompts for dynamic content:

```typescript
const result = await ask(data, provider,
  "For {{domain}}: What are the key takeaways from '{{title}}'?",
  { key: 'takeaways' }
);
```

Available placeholders:
- `{{title}}` - Page title
- `{{url}}` - Full URL
- `{{content}}` - Main content
- `{{description}}` - Meta description
- `{{excerpt}}` - Content excerpt
- `{{domain}}` - Hostname only

## Error Handling

LLM enhancements can fail without failing the entire scrape:

```typescript
const result = await scrape(url, { llm: provider, enhance: ['summarize'] });

if (result.summary) {
  console.log('Summary:', result.summary);
} else {
  console.log('Summary enhancement failed or was skipped');
}
```

## Next Steps

- [Custom Extractors](/guides/custom-extractors) - Create domain-specific extractors
- [API Reference: LLM Providers](/api/llm-providers) - Full provider API documentation
